<div class="full">
    <canvas id="color-canvas"></canvas>
    <script>
        $(function(){
            var drawingCanvas = document.getElementById('color-canvas');
            drawingCanvas.width = window.innerWidth;
            drawingCanvas.height = window.innerHeight;

            var ctx;
            if(drawingCanvas.getContext) {
                ctx = drawingCanvas.getContext('2d');
                ctx.lineCap = 'round';
                ctx.lineWidth = 5;
            }
            else {
                alert('No canvas support!');
                return;
            }

            function randomHSLColor(lightness) {
                return "hsl("+ Math.round(Math.random() * 255) +", 100%, "+ Math.round(lightness/2) +"%)";
            }


            var points = [];

            var hammer = new Hammer(document.getElementById('color-canvas'), {
                hold: false,
                tap: false,
                tap_double: false,
                drag: true,
                drag_vertical: true,
                drag_horizontal: true,
                transform: false,
                prevent_default: true
            });

            hammer.ondrag = function(event){
                for(var t=0, len=event.touches.length; t<len; t++) {
                    points.unshift({ x: event.touches[t].x, y: event.touches[t].y });
                }

                // allow max 100 points
                points.splice(100, 100);

                return false;
            };


            function drawDot(x, y, opacity) {
                if(!ctx) {
                    return;
                }

                ctx.fillStyle = randomHSLColor(opacity);
                ctx.beginPath();
                ctx.arc( x, y, ((opacity*3) / 10), 0, Math.PI*2, true );
                ctx.closePath();
                ctx.fill();
            }


            setInterval(function() {
                if(!ctx) {
                    return;
                }

                ctx.fillStyle = 'rgb(0,0,0)';
                ctx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height);

                for(var i=100; i>0; i--) {
                    if(!points[i]) {
                        continue;
                    }

                    drawDot(points[i].x, points[i].y, 100 - i);
                }
            }, 1000/35)

        });
    </script>
</div>
